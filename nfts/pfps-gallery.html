<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Casino Society PFP Gallery: Explore all 300 unique PFPs with traits, rarity, and metadata.">
    <meta name="keywords" content="casino society pfp, xrp nft gallery, casino traits, rarity">
    <meta property="og:title" content="Casino Society PFP Gallery">
    <meta property="og:description" content="Explore all 300 unique Casino Society PFPs with traits, rarity, and metadata. No crying in the casino.">
    <meta property="og:image" content="https://anthonyznft.github.io/casino_society_website/assets/b_garlinghouse.png">
    <meta property="og:url" content="https://anthonyznft.github.io/casino_society_website/nfts/pfps-gallery.html">
    <meta property="og:type" content="website">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Casino Society PFP Gallery">
    <meta name="twitter:description" content="Explore all 300 unique Casino Society PFPs with traits, rarity, and metadata. No crying in the casino.">
    <meta name="twitter:image" content="https://anthonyznft.github.io/casino_society_website/assets/b_garlinghouse.png">
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "CollectionPage",
      "name": "Casino Society PFP Gallery",
      "url": "https://anthonyznft.github.io/casino_society_website/nfts/pfps-gallery.html",
      "description": "Gallery of 300 unique Casino Society PFPs with traits and rarity details."
    }
    </script>
    <title>Casino Society PFP Gallery</title>
    <link rel="canonical" href="https://anthonyznft.github.io/casino_society_website/nfts/pfps-gallery.html">
    <link rel="stylesheet" href="../styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Arial&display=swap" rel="stylesheet">
    <link rel="icon" href="../favicon.ico" type="image/x-icon">
</head>
<body>
    <header class="header">
        <div class="header__container">
            <a href="../index.html" class="header__logo">Casino Society</a>
            <nav class="header__nav" id="mobile-menu">
                <ul class="header__nav-list">
                    <li><a href="../index.html#about" class="header__nav-link">About</a></li>
                    <li><a href="../index.html#ethos" class="header__nav-link">Ethos</a></li>
                    <li><a href="../index.html#collections" class="header__nav-link">NFT Collections</a></li>
                    <li><a href="../index.html#memes" class="header__nav-link">Memes</a></li>
                    <li><a href="../index.html#faq" class="header__nav-link">FAQ</a></li>
                </ul>
                <button class="header__menu-toggle" aria-label="Toggle Menu" id="menu-toggle">☰</button>
            </nav>
        </div>
    </header>

    <main class="main">
        <section class="section pfps-gallery">
            <div class="section__container">
                <h1 class="section__title">Casino Society PFP Gallery</h1>
                <p class="section__subtitle">Explore all 300 unique PFPs with traits and rarity details. No crying in the casino.</p>
                <div class="gallery-controls">
                    <input type="text" id="search-input" placeholder="Search NFTs..." aria-label="Search NFTs">
                    <select id="rarity-filter" aria-label="Filter by Rarity">
                        <option value="">All Rarity</option>
                        <option value="Common">Common</option>
                        <option value="Rare">Rare</option>
                        <option value="Epic">Epic</option>
                        <option value="Legendary">Legendary</option>
                    </select>
                    <select id="trait-filter" aria-label="Filter by Trait">
                        <option value="">All Traits</option>
                    </select>
                </div>
                <div id="gallery-grid" class="gallery__grid"></div>
                <div id="loading" class="loading">Loading NFTs...</div>
                <button id="load-more" class="btn" style="display: none;">Load More</button>
            </div>
        </section>
    </main>

    <footer class="footer">
        <div class="footer__container">
            <p>© 2025 Casino Society. All rights reserved. Send ourselves and each other higher. No Crying in the Casino.</p>
            <div class="footer__social">
                <a href="https://x.com/CasinoSociety_" class="footer__social-link">X</a>
                <span class="footer__social-divider">|</span>
                <a href="https://discord.gg/68hXWT4VAZ" class="footer__social-link">Discord</a>
            </div>
        </div>
    </footer>

    <script src="../script.js" async></script>
    <script>
        let allNfts = [];
        let currentPage = 0;
        const PAGE_SIZE = 20;
        let filters = { search: '', rarity: '', trait: '' };

        async function fetchNfts() {
            try {
                const response = await fetch('nfts.csv');
                if (!response.ok) throw new Error(`Fetch error: ${response.status}`);
                const csvText = await response.text();
                const data = Papa.parse(csvText, { header: true, skipEmptyLines: true });
                allNfts = data.data;
                return allNfts;
            } catch (error) {
                console.error('Fetch error:', error);
                document.getElementById('loading').textContent = 'Error loading NFTs. Please refresh.';
                return [];
            }
        }

        function parseImageUrl(imageString) {
            const match = imageString.match(/\((https?:\/\/.*?)\)/);
            return match ? match[1] : '../assets/b_garlinghouse.png';
        }

        function renderNft(nft) {
            const imageUrl = parseImageUrl(nft.image || '');
            const traits = nft.Traits ? nft.Traits.join(', ') : 'None';
            const rarity = nft.Rarity || 'Unknown';
            return `
                <div class="nft-card">
                    <img src="${imageUrl}" alt="${nft.name || 'NFT'}" loading="lazy" class="nft-card__image">
                    <h3 class="nft-card__name">${nft.name || 'Unnamed NFT'}</h3>
                    <p class="nft-card__rarity">Rarity: ${rarity}</p>
                    <p class="nft-card__traits">Traits: ${traits}</p>
                    <p class="nft-card__description">${nft.description || 'No description available.'}</p>
                </div>
            `;
        }

        function renderGallery(nfts) {
            const grid = document.getElementById('gallery-grid');
            const start = currentPage * PAGE_SIZE;
            const end = start + PAGE_SIZE;
            grid.innerHTML += nfts.slice(start, end).map(renderNft).join('');
            document.getElementById('loading').style.display = 'none';
            if (end >= nfts.length) {
                document.getElementById('load-more').style.display = 'none';
            } else {
                document.getElementById('load-more').style.display = 'block';
            }
        }

        async function loadMore() {
            currentPage++;
            const filteredNfts = applyFilters(allNfts);
            renderGallery(filteredNfts);
        }

        function applyFilters(nfts) {
            return nfts.filter(nft => {
                const name = nft.name ? nft.name.toLowerCase() : '';
                const traits = nft.Traits ? nft.Traits.join(' ').toLowerCase() : '';
                const description = nft.description ? nft.description.toLowerCase() : '';
                const rarity = nft.Rarity ? nft.Rarity.toLowerCase() : '';
                const matchesSearch = !filters.search || name.includes(filters.search) || traits.includes(filters.search) || description.includes(filters.search);
                const matchesRarity = !filters.rarity || rarity === filters.rarity.toLowerCase();
                const matchesTrait = !filters.trait || traits.includes(filters.trait.toLowerCase());
                return matchesSearch && matchesRarity && matchesTrait;
            });
        }

        document.addEventListener('DOMContentLoaded', async () => {
            document.getElementById('search-input').addEventListener('input', () => {
                filters.search = document.getElementById('search-input').value.toLowerCase();
                currentPage = 0;
                document.getElementById('gallery-grid').innerHTML = '';
                renderGallery(applyFilters(allNfts));
            });
            document.getElementById('rarity-filter').addEventListener('change', () => {
                filters.rarity = document.getElementById('rarity-filter').value;
                currentPage = 0;
                document.getElementById('gallery-grid').innerHTML = '';
                renderGallery(applyFilters(allNfts));
            });
            document.getElementById('trait-filter').addEventListener('change', () => {
                filters.trait = document.getElementById('trait-filter').value;
                currentPage = 0;
                document.getElementById('gallery-grid').innerHTML = '';
                renderGallery(applyFilters(allNfts));
            });
            document.getElementById('load-more').addEventListener('click', loadMore);
            const nfts = await fetchNfts();
            renderGallery(nfts);
            const traits = [...new Set(nfts.flatMap(nft => (nft.Traits ? nft.Traits.split(', ') : [])))];
            const traitSelect = document.getElementById('trait-filter');
            traits.forEach(trait => {
                const option = document.createElement('option');
                option.value = trait;
                option.textContent = trait;
                traitSelect.appendChild(option);
            });
        });
    </script>
</body>
</html>
